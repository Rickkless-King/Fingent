# ==============================================
# Fingent 业务配置
# ==============================================

# 时区设置
timezone: "America/New_York"

# ==============================================
# 数据源配置
# ==============================================
providers:
  # 行情数据源优先级
  quote:
    us_equity: finnhub      # 美股行情
    crypto: okx             # 加密货币
    fallback: polygon       # 备用（免费额度模式）

  # 新闻数据源优先级 (旧配置，用于基础新闻)
  news:
    primary: alphavantage
    fallback: finnhub

# ==============================================
# 新闻提供者配置 (用于套利触发)
# ==============================================
news_providers:
  # 优先级顺序 (越靠前越优先)
  priority:
    - marketaux      # 金融新闻，有情绪分析，100次/天
    - fmp            # 金融数据，500MB/月
    - gnews          # 通用新闻，支持搜索，100次/天
    - finnhub        # 已有，作为最终备用

  # 每日额度限制
  daily_limits:
    marketaux: 100
    fmp: 200         # 带宽限制，估算值
    gnews: 100
    finnhub: 1000    # 60/分钟，日限高

  # 缓存 TTL (秒) - 新闻缓存时间较短以获取更新内容
  cache_ttl:
    marketaux: 300   # 5 分钟
    fmp: 300         # 5 分钟
    gnews: 300       # 5 分钟
    finnhub: 60      # 1 分钟 (已在上面配置)

  # 宏观数据
  macro:
    primary: fred
    fallback: dbnomics

  # 情绪数据 (可选)
  sentiment:
    polymarket:
      enabled: true        # 默认关闭，需手动启用

# ==============================================
# 运行模式与免费额度配置
# ==============================================
usage_mode:
  name: free
  enabled: true

  # API 调用预算（免费额度）
  quotas:
    finnhub:
      per_minute: 60
    alphavantage:
      per_day: 25
    polygon:
      per_minute: 5

  # 缓存策略（秒）
  cache_ttl:
    default: 1800
    providers:
      finnhub: 60          # 降低到 1 分钟，获取更新的新闻
      alphavantage: 3600   # 降低到 1 小时
      polygon: 86400
      fred: 21600
      dbnomics: 21600

# ==============================================
# 监控资产列表
# ==============================================
assets:
  # 美股/ETF
  us_equity:
    - symbol: SPY
      name: "S&P 500 ETF"
    - symbol: QQQ
      name: "Nasdaq 100 ETF"
    - symbol: TLT
      name: "20+ Year Treasury Bond ETF"
    - symbol: GLD
      name: "Gold ETF"
    - symbol: VIX
      name: "Volatility Index"

  # 加密货币
  crypto:
    - symbol: BTC-USDT
      name: "Bitcoin"
    - symbol: ETH-USDT
      name: "Ethereum"

# ==============================================
# FRED 宏观指标
# ==============================================
macro_indicators:
  # 利率相关
  rates:
    - series_id: FEDFUNDS
      name: "Federal Funds Rate"
      frequency: monthly
    - series_id: DGS10
      name: "10-Year Treasury Rate"
      frequency: daily
    - series_id: DGS2
      name: "2-Year Treasury Rate"
      frequency: daily

  # 通胀相关
  inflation:
    - series_id: CPIAUCSL
      name: "CPI All Items"
      frequency: monthly
    - series_id: CPILFESL
      name: "Core CPI"
      frequency: monthly

  # 就业相关
  employment:
    - series_id: UNRATE
      name: "Unemployment Rate"
      frequency: monthly
    - series_id: PAYEMS
      name: "Nonfarm Payrolls"
      frequency: monthly

# ==============================================
# 告警规则 (Rule-based, 不依赖 LLM)
# ==============================================
alert_rules:
  # 跨资产异动
  - name: btc_crash
    description: "BTC 24h 跌幅超 8%"
    condition:
      metric: btc_24h_change
      operator: "<"
      threshold: -0.08
    severity: high

  - name: gold_surge
    description: "黄金 24h 涨幅超 3%"
    condition:
      metric: gold_24h_change
      operator: ">"
      threshold: 0.03
    severity: medium

  - name: vix_spike
    description: "VIX 超过 25"
    condition:
      metric: vix_level
      operator: ">"
      threshold: 25
    severity: high

  - name: yield_curve_inversion
    description: "2Y-10Y 利差倒挂加深"
    condition:
      metric: yield_spread_2y10y
      operator: "<"
      threshold: -0.5
    severity: high

  # 宏观异动
  - name: hawkish_shift
    description: "Fed 鹰派信号增强"
    condition:
      metric: hawkish_score
      operator: ">="
      threshold: 3
    severity: medium

# ==============================================
# 信号阈值配置
# ==============================================
signal_thresholds:
  # 价格变动阈值
  price_change:
    significant_24h: 0.05    # 5% 24h 变动视为显著
    significant_7d: 0.10     # 10% 7d 变动视为显著

  # 情绪阈值
  sentiment:
    bullish_threshold: 0.6
    bearish_threshold: 0.4

# ==============================================
# 计算规则 (写死，避免不一致)
# ==============================================
calculation_rules:
  # 24h 变化计算方式
  change_24h: "last_close / close_24h_ago - 1"
  change_7d: "last_close / close_7d_ago - 1"

  # 数据不足时的处理
  insufficient_data: "skip_with_warning"

# ==============================================
# 调度配置
# ==============================================
scheduler:
  # 每日报告时间 (美东时间)
  daily_report:
    enabled: true
    cron: "0 7 * * *"       # 每天早上 7:00

  # 盘中监控 (可选)
  intraday_check:
    enabled: false
    interval_minutes: 15

# ==============================================
# LLM 配置
# ==============================================
llm:
  # 主 LLM (用于报告生成)
  primary:
    provider: deepseek
    model: deepseek-chat
    temperature: 0.3
    max_tokens: 2000

  # 备用 LLM
  fallback:
    provider: qwen
    model: qwen-turbo
    temperature: 0.3
    max_tokens: 2000

  # 是否启用 LLM (关闭后只产出结构化数据)
  enabled: true

# ==============================================
# Polymarket 套利配置 (Arbitrage)
# ==============================================
arbitrage:
  # 是否启用套利检测
  enabled: true  # 默认关闭，需手动启用

  # 新闻触发关键词 (正则表达式)
  trigger_keywords:
    # AI/半导体
    - "(H200|H100|B100|NVIDIA|NVDA|Blackwell|HBM)"
    - "(TSMC|SK Hynix|Samsung|semiconductor|chip)"
    - "(GPU|AI|artificial intelligence)"
    # 宏观/美联储
    - "(Fed|CPI|inflation|rate cut|rate hike|FOMC|interest rate)"
    # 地缘政治
    - "(Trump|tariff|Greenland|trade war)"
    # 贵金属 - 黄金
    - "(gold|Gold|GOLD|黄金|XAU|GLD|XAUUSD|gold price|gold futures|bullion)"
    # 贵金属 - 白银
    - "(silver|Silver|SILVER|白银|XAG|SLV|XAGUSD|silver price|silver futures)"
    # 贵金属相关主题
    - "(precious metal|safe haven|避险|central bank gold|gold reserve|金价)"

  # 同义词映射 (用于扩展搜索)
  # 格式: 标准词 -> [同义词列表]
  synonym_map:
    # 贵金属
    gold: ["gold", "xau", "gld", "bullion", "gold price", "gold futures", "黄金", "金价"]
    silver: ["silver", "xag", "slv", "silver price", "silver futures", "白银", "银价"]
    precious_metal: ["precious metal", "贵金属", "safe haven", "避险资产"]
    # AI/GPU
    nvidia: ["nvidia", "nvda", "geforce", "cuda", "英伟达"]
    gpu: ["gpu", "graphics card", "显卡", "graphic processing"]
    ai: ["ai", "artificial intelligence", "人工智能", "machine learning", "ml"]
    # 半导体
    semiconductor: ["semiconductor", "chip", "芯片", "半导体", "fab", "foundry"]
    tsmc: ["tsmc", "台积电", "taiwan semiconductor"]
    # 宏观
    fed: ["fed", "federal reserve", "fomc", "美联储", "联储"]
    rate_cut: ["rate cut", "cut rate", "lower rate", "降息", "利率下调"]
    rate_hike: ["rate hike", "raise rate", "加息", "利率上调"]
    inflation: ["inflation", "cpi", "通胀", "物价"]
    # 地缘
    tariff: ["tariff", "import duty", "关税", "贸易壁垒"]
    trade_war: ["trade war", "贸易战", "trade conflict", "贸易摩擦"]

  # 监控的 Polymarket 标签
  polymarket_tags:
    - "ai"
    - "fed"
    - "politics"
    - "tech"
    - "crypto"

  # 期限结构策略参数
  term_structure:
    # Delta 差值阈值 (5% = 0.05)
    delta_threshold: 0.05
    # 触发窗口 (分钟)
    trigger_window_minutes: 120
    # 每个 event 最多监控的 market 数量
    max_markets_per_event: 10

  # 风控参数
  risk:
    # 最小 24h 成交量 (USD)
    min_volume_24h: 5000
    # 最大价差 (bps, 300 = 3%)
    max_spread_bps: 300
    # 最小深度 (USD)
    min_depth_usd: 1000
    # 距离结算最小时间 (小时)
    min_time_to_settle_hours: 12
    # 同一 event 冷却时间 (秒)
    cooldown_seconds: 900

  # 快照配置
  snapshot:
    # 快照过期时间 (秒, 6小时)
    ttl_seconds: 21600
    # 报价刷新间隔 (秒)
    quote_refresh_seconds: 60

  # 通知配置
  notify:
    # 是否推送 Telegram
    telegram_enabled: true
    # 节流时间 (分钟)
    throttle_minutes: 30
